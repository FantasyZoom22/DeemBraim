
<!DOCTYPE html>
<html>
<head>
    <title>Deem2Braim</title>
<script src="https://apis.google.com/js/api.js" onload="handleClientLoad()" onerror="handleClientLoad()"></script>

  <style>
 /* General Styles */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
}

h1 {
    text-align: center;
    color: #333;
}

/* Buttons */
button {
    padding: 10px 20px;
    background-color: #007BFF;
    color: #fff;
    border: none;
    cursor: pointer;
}

/* Dropdowns */
select {
    padding: 5px;
    width: 100%;
}

/* Table Styles */
table {
    border-collapse: collapse;
    width: 100%;
}

table, th, td {
    border: 1px solid #333;
}

th, td {
    padding: 10px;
    text-align: left;
}

th {
    background-color: #333;
    color: #fff;
}

/* Hide elements initially */
#spreadsheet-selector, #sheet-selector, #data-table {
    display: none;
}

  </style>
</head>
<body>
    <h1>OAuth with Google Sheets</h1>

    <div>
        <h2>Step 1: Connect to Google Sheets</h2>
        <button id="authorize-button">Connect with Google</button>
    </div>

    <div id="spreadsheet-selector" style="display: none;">
        <h2>Step 2: Select a Spreadsheet</h2>
        <select id="spreadsheet-dropdown">
            <!-- Populate spreadsheet options here -->
        </select>
    </div>

    <div id="sheet-selector" style="display: none;">
        <h2>Step 3: Select a Sheet</h2>
        <select id="sheet-dropdown">
            <!-- Populate sheet options here -->
        </select>
    </div>

    <div id="data-table" style="display: none;">
        <h2>Spreadsheet Data</h2>
        <table id="editable-table">
            <!-- Populate table data here -->
        </table>
    </div>

    <script>

        // Add your OAuth client ID here
const CLIENT_ID = '864103298246-ka196mjfhtk2j25vvh65kriq9dv0j180.apps.googleusercontent.com';

// Initialize the Google Sheets API client
const SCOPE = 'https://www.googleapis.com/auth/spreadsheets';
const DISCOVERY_DOCS = ['https://sheets.googleapis.com/$discovery/rest?version=v4'];

// Create the Google API client instance
let gapiClient;
let selectedSpreadsheetId;
let selectedSheetId;

function handleClientLoad() {
    gapi.load('client:auth2', initClient);
}

function initClient() {
    gapi.client.init({
        apiKey: 'AIzaSyAYsVQoSUpYDulbshcq7sqJXgCpMvYb4nM',
        clientId: CLIENT_ID,
        discoveryDocs: DISCOVERY_DOCS,
        scope: SCOPE
    }).then(function () {
        // Listen for sign-in state changes
        gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
        // Handle the initial sign-in state
        updateSigninStatus();
    });
}

function updateSigninStatus(isSignedIn) {
    if (isSignedIn) {
        document.getElementById('authorize-button').style.display = 'none';
        document.getElementById('spreadsheet-selector').style.display = 'block';
        // Fetch and populate the list of available spreadsheets
        listSpreadsheets();
    } else {
        document.getElementById('authorize-button').style.display = 'block';
        document.getElementById('spreadsheet-selector').style.display = 'none';
    }
}

function listSpreadsheets() {
    gapi.client.sheets.spreadsheets.list({}).then(function(response) {
        const spreadsheets = response.result.files;
        const spreadsheetDropdown = document.getElementById('spreadsheet-dropdown');
        spreadsheetDropdown.innerHTML = '';
        spreadsheets.forEach(function(spreadsheet) {
            const option = document.createElement('option');
            option.value = spreadsheet.id;
            option.textContent = spreadsheet.name;
            spreadsheetDropdown.appendChild(option);
        });
        spreadsheetDropdown.addEventListener('change', selectSpreadsheet);
    });
}

function selectSpreadsheet() {
    selectedSpreadsheetId = document.getElementById('spreadsheet-dropdown').value;
    document.getElementById('sheet-selector').style.display = 'block';
    // Fetch and populate the list of sheets in the selected spreadsheet
    listSheets();
}

function listSheets() {
    gapi.client.sheets.spreadsheets.get({
        spreadsheetId: selectedSpreadsheetId
    }).then(function(response) {
        const sheets = response.result.sheets;
        const sheetDropdown = document.getElementById('sheet-dropdown');
        sheetDropdown.innerHTML = '';
        sheets.forEach(function(sheet) {
            const option = document.createElement('option');
            option.value = sheet.properties.sheetId;
            option.textContent = sheet.properties.title;
            sheetDropdown.appendChild(option);
        });
        sheetDropdown.addEventListener('change', selectSheet);
    });
}

function selectSheet() {
    selectedSheetId = parseInt(document.getElementById('sheet-dropdown').value, 10);
    document.getElementById('data-table').style.display = 'block';
    // Fetch and display the data from the selected sheet
    displaySheetData();
}

function displaySheetData() {
    // Use the Google Sheets API to fetch data from the selected sheet and populate the table
    // You'll need to handle reading and writing data here
}

    </script>
</body>
</html>

