<!DOCTYPE html>
<html>
<head>
  <title>Deem2Braim</title>
  <script src="https://apis.google.com/js/api.js"></script>
  <style>
  body {
    text-align: center;
}

button, select {
    margin: 10px;
}

#tableContainer {
    margin: 20px;
    padding: 10px;
    border: 1px solid #ccc;
}

  </style>
</head>
<body>
    <button id="connectButton">Connect to Google Sheets</button>
    <select id="spreadsheetSelector"></select>
        <select id="sheetSelector"></select>
    <div id="tableContainer"></div>
    
    <script>
let spreadsheetId;
let sheetId;

function loadSheetsAPI() {
    gapi.load('client', initSheetsAPI);
}

function initSheetsAPI() {
    gapi.client.init({
        apiKey: 'AIzaSyAYsVQoSUpYDulbshcq7sqJXgCpMvYb4nM',
        discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
    }).then(function () {
        // API is initialized, you can now use gapi.client.sheets

        // Fetch a list of spreadsheets and populate the dropdown
        gapi.client.drive.files
            .list({
                q: "mimeType='application/vnd.google-apps.spreadsheet'",
            })
            .then(function (response) {
                const spreadsheets = response.result.files;
                const spreadsheetSelector = document.getElementById('spreadsheetSelector');
                spreadsheetSelector.style.display = 'block';

                spreadsheets.forEach((spreadsheet) => {
                    const option = document.createElement('option');
                    option.value = spreadsheet.id;
                    option.text = spreadsheet.name;
                    spreadsheetSelector.appendChild(option);
                });

                // Event listener for spreadsheet selection
                spreadsheetSelector.addEventListener('change', displaySpreadsheet);
            });
    });
}

    </script>
</body>
</html>
